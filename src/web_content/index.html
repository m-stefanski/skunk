<html>
  <head>
    <title>Skunks</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" /> 
    <link rel="stylesheet" type="text/css" href="style.css" media="screen"/>
    <link rel="icon" type="image/png" size="32x32" href="favicon.png" />
    <link rel="apple-touch-icon" href="favicon.png" />
  </head>  
  <body>
    <div class="header">
      <img src="skunk.svg" />
      <h1>kunks</h1>
    </div>
    <table>
      <tr>
        <td>Temperature</td>
        <td class="value"><span id="temp">-</span></td>
      </tr>
      <tr>
        <td>Humidity</td>
        <td class="value"><span id="humid">-</span></td>
      </tr>
      <tr>
        <td>Pressure</td>
        <td class="value"><span id="pres">-</span></td>
      </tr>
    </table>
    <div class='status' id='status'></div>
  </body>
  <script>
  function reload_data () {
    var xhr = new XMLHttpRequest();
    xhr.onreadystatechange = function(){
      if (xhr.readyState === 4){
        var params = JSON.parse(xhr.responseText);
        document.getElementById('temp').innerHTML = params.temperature.toFixed(1) + "&#176;C";
        document.getElementById('humid').innerHTML = params.humidity.toFixed(1) + "%";
        document.getElementById('pres').innerHTML = params.pressure.toFixed(1) + "hPa";
        var now = new Date();
        document.getElementById('status').innerHTML = "Last update: "+ now.toTimeString();
        document.getElementById('error').style.display = "none";
      }
    };
    xhr.onerror = function () {
      document.getElementById('error').style.display = "block";
    };
    xhr.open('GET', '/sensors/');
    xhr.send();
  }
  setInterval(reload_data, 1000);
  </script>
</html>